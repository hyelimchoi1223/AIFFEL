![image](https://user-images.githubusercontent.com/63278762/123659411-9fdc9380-d86d-11eb-9f26-0d97b6eaa300.png)
>
> íŒŒì´ì¬ ì½”ë”©ì˜ ê¸°ìˆ ì„ ê³µë¶€í•˜ëŠ” í’€ì

# ğŸ“ ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©
## Better Way 70. ìµœì í™”í•˜ê¸° ì „ì— í”„ë¡œíŒŒì¼ë§ì„ í•˜ë¼.
  - íŒŒì´ì¬ì˜ ë™ì ì¸ íŠ¹ì„±ë•Œë¬¸ì— ì‹¤í–‰ì‹œê°„ ì„±ëŠ¥ì´ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ë•Œê°€ ìˆë‹¤.
- ìµœì í™” í•˜ê¸° ì „ í”„ë¡œê·¸ë¨ì´ ëŠë ¤ì§€ëŠ” ì›ì¸ì„ ëª…í™•í•˜ê²Œ ë³´ê¸° ìœ„í•´ì„œ í”„ë¡œê·¸ë¨ ì„±ëŠ¥ì„ ì§ì ‘ ì¸¡ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.â†’ ì´ê²ƒì„ ë„ì™€ì£¼ëŠ” ê²ƒì´ **í”„ë¡œíŒŒì¼ëŸ¬**ì´ë‹¤
- í”„ë¡œíŒŒì¼ëŸ¬ : í”„ë¡œê·¸ë¨ì˜ ê° ë¶€ë¶„ì´ ì‹¤í–‰ì‹œê°„ ì¸¡ì •.
- íŒŒì´ì¬ ë‚´ì¥ í”„ë¡œíŒŒì¼ëŸ¬    
ì±…ì—ì„œë‚˜ ê³µì‹ë¬¸ì„œì—ì„œë‚˜ cProfileì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. profileì˜ ê²½ìš° í”„ë¡œíŒŒì¼ë§í•˜ëŠ” í”„ë¡œê·¸ë¨ ì„±ëŠ¥ì— ë¶€í•˜ë¥¼ ì¤€ë‹¤.

1. profile : íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„± â†’ í”„ë¡œíŒŒì¼ëŸ¬ë¥¼ í™•ì¥í•´ì„œ ì‚¬ìš©í•˜ë ¤ê³  í• ë•Œ ì‚¬ìš©í•˜ë©´ ì¢‹ìŒ.
2. cProfile : C í™•ì¥ ëª¨ë“ˆ    
[The Python Profilers - Python 3.9.6 documentation](https://docs.python.org/ko/3/library/profile.html)

- ì£¼ì˜í•  ì  : í”„ë¡œíŒŒì¼ë§í• ë•Œ ì™¸ë¶€ ì‹œìŠ¤í…œì˜ ì„±ëŠ¥(ë„¤íŠ¸ì›Œí¬ë‚˜ ë””ìŠ¤í¬ ìì›ì— ì ‘ê·¼ ë“±)ì´ ì•„ë‹ˆë¼ ì½”ë“œ ìì²´ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ë„ë¡ í•´ì•¼ í•œë‹¤.
- ì„±ëŠ¥ ì¸¡ì •í•  í•¨ìˆ˜

    ```python
    from random import randint

    def insertion_sort(data):
        result = []
        for value in data:
            insert_value(result, value)
        return result

    def insert_value(array, value):
        for i, existing in enumerate(array):
            if existing > value:
                array.insert(i, value)
                return
        array.append(value)
    ```

1. ë°ì´í„° ì§‘í•©ì„ ë§Œë“¤ê³  í”„ë¡œíŒŒì¼ëŸ¬ì— ë„˜ê¸¸ testí•¨ìˆ˜ë¥¼ ì •ì˜

    ```python
    from random import randint

    max_size = 10**4
    data = [randint(0, max_size) for _ in range(max_size)]

    # test = lambda: insertion_sort(data)
    def test(): return insertion_sort(data)
    print(type(test)) # <class 'function'>
    ```

2. `Profile` ì‚¬ìš©í•´ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ ì‹¤í–‰

    ```python
    from cProfile import Profile

    profiler = Profile()
    profiler.runcall(test)
    ```

3. Stats í´ë˜ìŠ¤ë¡œ ì„±ëŠ¥ í†µê³„ë¥¼ ì¶”ì¶œ

    ```python
    from pstats import Stats

    stats = Stats(profiler)
    stats.strip_dirs()
    stats.sort_stats('cumulative') # ëˆ„ì í†µê³„
    stats.print_stats()
    ```

    ```python
    20003 function calls in 2.377 seconds

    Ordered by: cumulative time

    ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    1    0.000    0.000    2.377    2.377 [test.py:25](http://test.py:25/)(test)
    1    0.014    0.014    2.377    2.377 [test.py:6](http://test.py:6/)(insertion_sort)
    10000    2.335    0.000    2.362    0.000 [test.py:13](http://test.py:13/)(insert_value)
    9990    0.027    0.000    0.027    0.000 {method 'insert' of 'list' objects}
    10    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
    1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
    ```

    - ncalls : í”„ë¡œíŒŒì¼ë§ í•˜ëŠ” ë™ì•ˆ í•¨ìˆ˜ê°€ ëª‡ ë²ˆ í˜¸ì¶œë˜ì—ˆëŠ”ì§€
    - tottime : í”„ë¡œíŒŒì¼ë§ í•˜ëŠ” ë™ì•ˆ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ”ë° ì–¼ë§ˆë‚˜ ê±¸ë ¸ëŠ”ì§€. (ëŒ€ìƒ í•¨ìˆ˜ì—ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ ê²½ìš°, ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ì‹œê°„ì„ ì œì™¸.â†’ ìˆœìˆ˜í•˜ê²Œ ëŒ€ìƒ í•¨ìˆ˜ì—ì„œ ì‹¤í–‰í•œ ì‹œê°„ë§Œ ì¸¡ì •)
    - cumtime : í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ë•Œ ê±¸ë¦° ëˆ„ì ì‹œê°„.(ëŒ€ìƒ í•¨ìˆ˜ì—ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ì‹œê°„ë„ ëª¨ë‘ í¬í•¨.)
4. ì—¬ê¸°ì„œ ì œì¼ ì˜¤ë˜ ê±¸ë¦° í•¨ìˆ˜ëŠ” insert_valueì¸ë° ì €ìëŠ” ì´ ë¶€ë¶„ì„ bisectì„ ì´ìš©í•´ì„œ ì†ë„ë¥¼ ë†’ì˜€ë‹¤.
- stats.print_callers() : í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ì–¼ë§ˆë‚˜ ê¸°ì—¬í–ˆëŠ”ì§€ ë³´ì—¬ì¤€ë‹¤.
    - ì„±ëŠ¥ ì¸¡ì •í•  í•¨ìˆ˜

        ```python
        def my_function(a, b):
            c = 1
            for i in range(100):
                c += a*b

        def first_func():
            for _ in range(1000):
                my_function(4, 5)

        def second_func():
            for _ in range(10):
                my_function(1, 2)

        def my_program():
            for _ in range(20):
                first_func()
                second_func()
        ```

    ```python
    profile = Profile()
    profile.runcall(my_program)

    stats = Stats(profile)
    stats.strip_dirs()
    stats.print_stats()
    stats.print_callers()
    ```

    1. `print_stats()` ê²°ê³¼

    ```python
    20242 function calls in 0.268 seconds

        Random listing order was used

        ncalls  tottime  percall  cumtime  percall filename:lineno(function)
            1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        20200    0.260    0.000    0.260    0.000 test2.py:5(my_function)
            20    0.008    0.000    0.266    0.013 test2.py:11(first_func)
            20    0.000    0.000    0.002    0.000 test2.py:16(second_func)
            1    0.000    0.000    0.268    0.268 test2.py:21(my_program)
    ```

    2. `print_callers()` ê²°ê³¼

    ì™¼ìª½ì€ í˜¸ì¶œëœ í•¨ìˆ˜, ì˜¤ë¥¸ìª½ì€ ê·¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ í•¨ìˆ˜

    ```python
    Random listing order was used

    Function                                          was called by...
                                                            ncalls  tottime  cumtime
    {method 'disable' of '_lsprof.Profiler' objects}  <- 
    test2.py:5(my_function)                           <-   20000    0.258    0.258  test2.py:11(first_func)
                                                                200    0.002    0.002  test2.py:16(second_func)
    test2.py:11(first_func)                           <-      20    0.008    0.266  test2.py:21(my_program)
    test2.py:16(second_func)                          <-      20    0.000    0.002  test2.py:21(my_program)
    test2.py:21(my_program)                           <-
    ```

> â“- bisect : ë°°ì—´ ì´ì§„ ë¶„í•  ì•Œê³ ë¦¬ì¦˜    
[bisect - Array bisection algorithm - Python 3.9.6 documentation](https://docs.python.org/ko/3/library/bisect.html)
>
> [[Python] bisect](https://seing.tistory.com/124)
>
```python
from bisect import bisect_left, bisect_right
a = [1, 3, 5, 7, 9, 10]

# aëŠ” ì •ë ¬ë˜ì–´ìˆë‹¤ê³  ê°€ì •
# ë‘˜ì˜ ê³µí†µì ì€ valueê°€ ë“¤ì–´ê°ˆ ì¸ë±ìŠ¤ë¥¼ ì°¾ì•„ì£¼ëŠ” í•¨ìˆ˜
value = 2
i = bisect_left(a, value) 
print(i) # 1

j = bisect_right(a, value)
print(j) # 1
```

> - bisect_leftì™€ bisect_rightì˜ ì°¨ì´ì     
valueì™€ ë™ì¼í•œ ê°’ì´ ìˆì„ ë•Œ bisect_leftëŠ” ë™ì¼í•œ ê°’ì˜ ì™¼ìª½ ì¸ë±ìŠ¤ ë°˜í™˜, bisect_rightëŠ” ë™ì¼í•œ ê°’ì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜

```python
a = [1, 2, 3, 5, 7, 9, 10]

# aëŠ” ì •ë ¬ë˜ì–´ìˆë‹¤ê³  ê°€ì •
value = 2
i = bisect_left(a, value)
print(i) # 1

j = bisect_right(a, value)
print(j) # 2
```