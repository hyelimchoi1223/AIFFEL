![image](https://user-images.githubusercontent.com/63278762/123659411-9fdc9380-d86d-11eb-9f26-0d97b6eaa300.png)
>
> íŒŒì´ì¬ ì½”ë”©ì˜ ê¸°ìˆ ì„ ê³µë¶€í•˜ëŠ” í’€ì

# ğŸ“ ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©
## Better Way 28. ì»¨í”„ë¦¬í—¨ì…˜ ë‚´ë¶€ì— ì œì–´ í•˜ìœ„ ì‹ì„ ì„¸ ê°œ ì´ìƒ ì‚¬ìš©í•˜ì§€ ë§ë¼.
```python
# 3ë‹¨ê³„ ì´ìƒì˜ ë¦¬ìŠ¤íŠ¸ê°€ ìˆì„ ë•Œ
my_lists = [
    [[1,2,3],[4,5,6]]
    ,,,
]

flat = [x for sublist1 in my_lists
for sublist2 in sublist1
for x in sublist2]
```
ì´ ê²½ìš° ë°˜ë³µë¬¸ì„ í†µí•´ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ë” ëª…í™•í•˜ë‹¤.
```python
flat = []
for sublist1 in my_lists:
    for sublist2 in sublist1:
        flat.extend(sublist2)
```
ì»¨í”„ë¦¬í—¨ì…˜ì€ ì—¬ëŸ¬ if ì¡°ê±´ì„ í—ˆìš©í•˜ëŠ”ë° ê°™ì€ ìˆ˜ì¤€ì˜ ë£¨í”„ì—ì„œ ì‚¬ìš©í•˜ë©´ ì•”ì‹ì ìœ¼ë¡œ andë¥¼ ì˜ë¯¸í•œë‹¤.
```python
a = [1,2,3,4,5,6,7,8,9]
b = [x for x in a if x > 4 if x % 2 ==0]
c = [x for x in a if x > 4 and x % 2 ==0]
# [6, 8]
# [6, 8]
```
ì»¨í”„ë¦¬í—¨ì…˜ì´ ë³µì¡í•´ì§ˆ ê²½ìš° ì¼ë°˜ ifì™€ ë„ìš°ë¯¸ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ë¼.

## Better Way 29. ëŒ€ì…ì‹ì„ ì‚¬ìš©í•´ ì»´í”„ë¦¬í—¨ì…˜ ì•ˆì—ì„œ ë°˜ë³µ ì‘ì—…ì„ í”¼í•´ë¼.
```python
stock = {
    'ëª»': 125,
    'ë‚˜ì‚¬ëª»': 35,
    'ë‚˜ë¹„ë„ˆíŠ¸': 8,
    'ì™€ì…”': 24,
}

order = ['ë‚˜ì‚¬ëª»', 'ë‚˜ë¹„ë„ˆíŠ¸', 'í´ë¦½']

def get_batches(count, size):
    return count // size

result = {}
for name in order:
    count = stock.get(name, 0)
    batches = get_batches(count, 8)
    if batches:
        result[name] = batches
```
ë”•ì…”ë„ˆë¦¬ ì»´í”„ë¦¬í—¨ì…˜ì„ ì‚¬ìš©í•´ ë” ê°„ê²°í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
```python
result = {name: get_batches(stock.get(name,0), 8)
         for name in order
         if get_batches(stock.get(name, 0), 8)
}
```
`get_batches`ë¶€ë¶„ì´ ë°˜ë³µë˜ë¯€ë¡œ ì™ˆëŸ¬ìŠ¤ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•´ ìˆ˜ì •í•´ë³´ë©´
```python
result = {name: batches for name in order
         if batches := get_batches(stock.get(name, 0), 8)}
```
ëŒ€ì…ì‹ì„ ì¡°ê±´ì—ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤. ì™œëƒí•˜ë©´ ë‹¤ë¥¸ ë¶€ë¶„ì— ì‚¬ìš©í•˜ë©´ ë£¨í”„ ë°–ìœ¼ë¡œ ë£¨í”„ ë³€ìˆ˜ê°€ ëˆ„ì¶œë˜ê¸° ë•Œë¬¸ì´ë‹¤.
> ### â“ì¼ë°˜ for ë£¨í”„ ë³€ìˆ˜ ëˆ„ì¶œ
> ```python
> for count in range(10):
>     pass
> print(count)
> # 9
> ```
> ì»¨í”„ë¦¬í—¨ì…˜ì˜ ë£¨í”„ ë³€ìˆ˜ì¸ ê²½ìš° ë£¨í”„ ë³€ìˆ˜ ëˆ„ì¶œì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.

## Better Way 30. ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ê¸°ë³´ë‹¤ëŠ” ì œë„ˆë ˆì´í„°ë¥¼ ì‚¬ìš©í•˜ë¼.
* appendë¥¼ ì‚¬ìš©í•´ì„œ ë¦¬ìŠ¤íŠ¸ì— ê²°ê³¼ë¥¼ ì¶”ê°€í•˜ëŠ” ì½”ë“œì˜ ë¬¸ì œì 
    1. ì½”ë“œ ì¡ìŒì´ ë§ìŒ
    2. ë¦¬ìŠ¤íŠ¸ì— ëª¨ë“  ê²°ê³¼ë¥¼ ë‹¤ ì €ì¥í•´ì•¼ í•œë‹¤. ë©”ëª¨ë¦¬ ë¶€ì¡± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
```python
# ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©
def index_words(text):
    result = []
    if text:
        result.append(0)
    for index, letter in enumerate(text):
        if letter == ' ':
            result.append(index+1)
    return result
```
```python
# ì œë„ˆë ˆì´í„° ì‚¬ìš©
def index_words_iter(text):
    if text:
        yield 0
    for index, letter in enumerate(text):
        if letter == ' ':
            yield index + 1
```
* ì œë„ˆë ˆì´í„°ëŠ” ë°ì´í„° ì „ë¶€ë¥¼ ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ì§€ ì•Šê¸° ë•Œë¬¸ì— ê¸¸ì–´ë„ ì–´ëŠì •ë„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. 
* ì œë„ˆë ˆì´í„°ê°€ ë°˜í™˜í•˜ëŠ” ì´í„°ë ˆì´í„°ëŠ” ì§„í–‰í•œ ìƒíƒœë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì¬ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

>  ### â“Iterable vs Iterator
> * Iterable : ë°˜ë³µí•  ìˆ˜ ìˆëŠ” ê°ì²´    
>     string, list, dict, tuple, set
> * Iterator : `__next__()`ì„ ê°€ì§€ê³  ë””ìŒ ìˆœì„œì˜ ì•„ì´í…œì„ ë¦¬í„´    
>      iter() ë©”ì†Œë“œë¥¼ í†µí•´ iterator ê°ì²´ë¥¼ ë¦¬í„´í•˜ë ¤ë©´, ì•„ë˜ì˜ ë‘ ë©”ì†Œë“œ ì¤‘ í•˜ë‚˜ë¼ë„ êµ¬í˜„ì´ ë˜ì–´ì•¼ í•œë‹¤.
> `__iter__` : Iterator ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì†Œë“œ
> `__getItem__ (self, index)`: ì¸ìì˜ ì¸ë±ìŠ¤(0ë¶€í„° ì‹œì‘)ì— ë”°ë¥¸ itemì„ ë¦¬í„´í•˜ëŠ” ë‚´ìš©ì„ ì‘ì„±í•œ ë©”ì†Œë“œ    
> https://jisooo.tistory.com/entry/Python-Iterable%EA%B3%BC-Iterator-%ED%8A%B9%EC%A7%95-%EB%B0%8F-%EB%B9%84%EA%B5%90  

## Better Way 31. ì¸ìì— ëŒ€í•´ ì´í„°ë ˆì´ì…˜í•  ë•ŒëŠ” ë°©ì–´ì ì´ ë¼ë¼.
* ì´í„°ë ˆì´í„°ëŠ” StopIteration ì˜ˆì™¸ê°€ ì˜¤ê¸° ì „ê¹Œì§€ Next stepì„ ë°ŸëŠ” ê²ƒìœ¼ë¡œ, ì´ë¯¸ StopIterationì´ ë°œìƒí•œ ì´í„°ë ˆì´í„°ë‚˜ ì œë„ˆë ˆì´í„°ë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ì—†ë‹¤.
![stopiteration](https://user-images.githubusercontent.com/63278762/124480436-36670280-dde2-11eb-8f41-bd71e6e1de53.png)
```python
#
it = read_visits('my_numbers.txt')
percentages = normalize(it)
print(percentages)
#ê²°ê³¼
[]

it = read_visits('my_numbers.txt')
print(list(it))
print(list(it)) # ì´ë¯¸ ëª¨ë“  ì›ì†Œë¥¼ ë‹¤ ì†Œì§„í–ˆë‹¤
#ê²°ê³¼
[15, 35, 80]
[]
```
#### ì´ ë¬¸ì œì˜ í•´ê²° ë°©ë²•
1. ì´í„°ë ˆì´í„° ë³µì‚¬ : ë¦¬ìŠ¤íŠ¸ì˜ ë¬¸ì œì²˜ëŸ¼ ë©”ëª¨ë¦¬ë¥¼ ì—„ì²­ ë§ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
2. ì´í„°ë ˆì´í„° í”„ë¡œí† ì½œì„ êµ¬í˜„í•œ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆ í´ë˜ìŠ¤ ì œê³µ : `__iter__`ì„ ì¬ì •ì˜í•œë‹¤.
```python
def normalize(numbers):
    total = sum(numbers) # ìƒˆ ì´í„°ë ˆì´í„°
    result = []
    for value in numbers: # ìƒˆ ì´í„°ë ˆì´í„°
        percent = 100 * value / total
        result.append(percent)
    return result

class ReadVisits:
    def __init__(self, data_path):
        self.data_path = data_path

    def __iter__(self):
        with open(self.data_path) as f:
            for line in f:
                yield int(line)

#
path = 'my_numbers.txt'
visits = ReadVisits(path) # path : iterable, visits : iterable
percentages = normalize(visits)
print(percentages)
```
* ë°˜ë³µì ì¸ ì´í„°ë ˆì´ì…˜ í•  ìˆ˜ ì—†ëŠ” ì¸ìì¸ ê²½ìš° `TypeError`ë¥¼ ë°œìƒì‹œì¼œ ì¸ìë¥¼ ê±°ë¶€í•  ìˆ˜ ìˆë‹¤.
```python
def normalize_defensive(numbers):
    if iter(numbers) is numbers: # ì´í„°ë ˆì´í„° -- ë‚˜ì¨!
        raise TypeError('ì»¨í…Œì´ë„ˆë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤')
    total = sum(numbers)
    result = []
    for value in numbers:
        percent = 100 * value / total
        result.append(percent)
    return result

# isinstance í•¨ìˆ˜ ì‚¬ìš©
from collections.abc import Iterator

def normalize_defensive(numbers):
    if isinstance(numbers, Iterator): # ë°˜ë³µ ê°€ëŠ¥í•œ ì´í„°ë ˆì´í„°ì¸ì§€ ê²€ì‚¬í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•
        raise TypeError('ì»¨í…Œì´ë„ˆë¥¼ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤')
    total = sum(numbers)
    result = []
    for value in numbers:
        percent = 100 * value / total
        result.append(percent)
    return result
```
## Better Way 32. ê¸´ ë¦¬ìŠ¤íŠ¸ ì»´í”„ë¦¬í—¨ì…˜ë³´ë‹¤ëŠ” ì œë„ˆë ˆì´í„° ì‹ì„ ì‚¬ìš©í•˜ë¼.
* ë¦¬ìŠ¤íŠ¸ëŠ” ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•˜ëŠ” ë¬¸ì œê°€ ìˆê¸° ë•Œë¬¸ì— ì œë„ˆë ˆì´í„° ì‹ì„ ì´ìš©í•´ ì´í„°ë ˆì´í„°ë¥¼ ìƒì„±í•´ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
* ì œë„ˆë ˆì´í„° ì‹ : list comprehension ê³¼ generatorì„ ì¼ë°˜í™” -> ì œë„ˆë ˆì´í„° ì‹ì— ë“¤ì–´ìˆëŠ” expressionìœ¼ë¡œë¶€í„° ì›ì†Œë¥¼ í•˜ë‚˜ì”© ë§Œë“¤ì–´ë‚´ëŠ” ì´í„°ë ˆì´í„° ìƒì„±
```python
it = (len(x) for x in open('my_file.txt'))
```
ë‘ ì œë„ˆë ˆì´í„° ì‹ì„ í•©ì„±í•  ìˆ˜ ìˆë‹¤. ì•„ê²ƒì€ ë§¤ìš° ë¹ ë¥´ê³ , ë©”ëª¨ë¦¬ ì‚¬ìš©ë„ íš¨ìœ¨ì ì´ë‹¤.
```python
roots = ((x, x**0.5) for x in it)
```
ì• ë¶€ë¶„ê³¼ ë™ì¼í•˜ê²Œ ì´í„°ë ˆì´í„°ì—ëŠ” ë°˜í™˜í•œ ìƒíƒœê°€ ìˆê¸° ë•Œë¬¸ì— í•œë²ˆë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

## Better Way 33. yield fromì„ ì‚¬ìš©í•´ ì—¬ëŸ¬ ì œë„ˆë ˆì´í„°ë¥¼ í•©ì„±í•´ë¼.
```python
def move(period, speed):
	for _ in range(period):
		yield speed

def pause(delay):
	for _ in range(delay):
		yield 0

def animate():
	for delta in move(4, 5.0):
		yield delta
	for delta in pause(3):
		yield delta
	for delta in move(2, 3.0):
		yield delta        
```
ìœ„ ë¶€ë¶„ì„ yield fromì„ ì‚¬ìš©í•´ ê°„ë‹¨í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
```python
# yield from: ì œì–´ë¥¼ ë¶€ëª¨ ì œë„ˆë ˆì´í„°ë¡œ ë„˜ê¸°ê¸° ì „ì— ë‚´í¬ëœ ì œë„ˆë ˆì´í„°ì˜ ëª¨ë“  ê°’ì„ ë‚´ë³´ë‚¸ë‹¤

def animate():
	yield from move(4, 5.0)
	yield from pause(3)
	yield from move(2, 3.0)

# ê°€ë…ì„±ê³¼ ì„±ëŠ¥ ì¸¡ë©´ ëª¨ë‘ì—ì„œ ë” ì¢‹ë‹¤
```