![image](https://user-images.githubusercontent.com/63278762/123659411-9fdc9380-d86d-11eb-9f26-0d97b6eaa300.png)
>
> íŒŒì´ì¬ ì½”ë”©ì˜ ê¸°ìˆ ì„ ê³µë¶€í•˜ëŠ” í’€ìžŽ

# ðŸ“ ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©
## Better Way 16. inì„ ì‚¬ìš©í•˜ê³  ë”•ì…”ë„ˆë¦¬ í‚¤ê°€ ì—†ì„ ë•Œ KeyErrorë¥¼ ì²˜ë¦¬í•˜ê¸°ë³´ë‹¤ëŠ” getì„ ì‚¬ìš©í•˜ë¼.
Dictionaryì˜ ê²½ìš° inì„ ì‚¬ìš©í•˜ì—¬ keyì˜ ì¡´ìž¬ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆë‹¤.
```python
values = {'key1':'value1', 'key2':'value2'}
print('key3' in values) # False
```
* keyê°€ ì—†ì„ ë•Œ Defaultê°’ì„ ì£¼ëŠ” ì½”ë“œë¥¼ ì‹œí‚¤ê¸° ìœ„í•œ ë°©ë²•
```python
# ë°©ë²• 1
# ì´ ë°©ë²•ì˜ ê²½ìš° countersì—ì„œ keyë¥¼ ì°¾ê¸° ìœ„í•œ ì ‘ê·¼ 1ë²ˆ,countersì— ê°’ì„ ëŒ€ìž…í•˜ê¸° ìœ„í•œ key ì ‘ê·¼ 2ë²ˆì„ í•˜ê¸°ì— ë°˜ë³µì´ ì¼ì–´ë‚œë‹¤.
if key not in counters:
    counters[key] = 0
counters[key] += 1

# ë°©ë²• 2
try:
    counters[key] += 1
except KeyError:
    counters[key] = 1

# ë°©ë²• 3 : ì €ìžëŠ” ì´ ë°©ë²•ì„ ì¶”ì²œí•œë‹¤.
count = counters.get(key, 0)
counters[key] = count + 1
```
* `setdefault`ë¥¼ ì´ìš©í•´ ì²˜ë¦¬í•  ìˆ˜ ìžˆë‹¤.
í‚¤ê°€ ì—†ìœ¼ë©´ defaultê°’ì„ ë”•ì…”ë„ˆë¦¬ì— ëŒ€ìž…í•´ ê°’ì„ ë°˜í™˜í•œë‹¤.
```python
count = counters.setdefault(key, 0)
counters[key] = count + 1
```
#### getê³¼ setdefaultì˜ ë¹„êµ
getì˜ ê²½ìš° ë””í´íŠ¸ ê°’ì„ ë°˜í™˜ë§Œ í•  ë¿ ë”•ì…”ë„ˆë¦¬ì— ê°’ì„ ë„£ì–´ì£¼ì§„ ì•Šì§€ë§Œ, setdefaultì˜ ê²½ìš° ë”•ì…”ë„ˆë¦¬ì— ë””í´ë“œ ê°’ì„ ë„£ì€ í›„ ê°’ì„ ë°˜í™˜í•œë‹¤.
* setdefaultì˜ ë¬¸ì œì 
1. í‚¤ê°€ ì—†ì„ ë•Œ setdefaultì— ì „ë‹¬ëœ ë””í´íŠ¸ ê°’ì´ ë”•ì…”ë„ˆë¦¬ì— ì§ì ‘ ëŒ€ìž…ì´ ëœë‹¤.
2. ë§¤ë²ˆ ë””í´íŠ¸ ê°’ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
```python
    data = {}
    key = 'foo'
    value = []
    data.setdefault(key, value)
    print('ì´ì „:', data)
    value.append('hello') # value ë¦¬ìŠ¤íŠ¸ì— ê°’ì„ ì¶”ê°€í–ˆëŠ”ë° data dictionaryì•ˆì— ìžˆëŠ” ê°’ì´ ë³€ê²½ë¨.
    print('ì´í›„:', data)
```
> â“Counter í´ëž˜ìŠ¤    
>  ì €ìžê°€ ìœ„ì™€ ê°™ì´ ê°’ì˜ ê°œìˆ˜ë¥¼ ì„¸ ë”•ì…”ë„ˆë¦¬ë¡œ ë§Œë“œëŠ” ë²•ìœ¼ë¡œ ì¶”ì²œí•œ í´ëž˜ìŠ¤    
> ì»¨í…Œì´ë„ˆì— ë™ì¼í•œ ê°’ì˜ ìžë£Œê°€ ëª‡ ê°œì¸ì§€ë¥¼ íŒŒì•…í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” ê°ì²´.    
> ```python
> # ë¦¬ìŠ¤íŠ¸
> import collections
> lst = ['aa','cc','dd','aa','bb','ee']
> print(collections.Counter(lst))
> # ê²°ê³¼
> # Counter({'aa':2, 'cc':1, 'dd':1, 'bb':1, 'ee':1})
> ```    

> â“votes[key] = names = [] : ì—¬ëŸ¬ ê°’ì„ ë™ì‹œì— ëŒ€ìž….
> votes[key]ì™€ names ì•ˆì— []ë¥¼ ëŒ€ìž…í•œë‹¤.

## Better Way 17. ë‚´ë¶€ ìƒíƒœì—ì„œ ì›ì†Œê°€ ì—†ëŠ” ê²½ìš°ë¥¼ ì²˜ë¦¬í•  ë•ŒëŠ” setdefaultë³´ë‹¤ defaultdictë¥¼ ì‚¬ìš©í•˜ë¼.
```python
class Visits:
    def __init__(self):
        self.data = {}
    
    def add(self, country, city):
        city_set = self.data.setdefault(country, set()) # ë©”ë²ˆ í˜¸ì¶œ ë  ë•Œë§ˆë‹¤ setì„ ë§Œë“¤ì–´ì„œ ë¹„íš¨ìœ¨ì .
        city_set.add(city) # setìœ¼ë¡œ ì´ˆê¸°í™” í›„ ë‹¤ì‹œ ê°’ì„ ìž…ë ¥í•˜ê²Œ ë˜ ë¹„íš¨ìœ¨ì 
```
ì´ ëŒ€ì•ˆìœ¼ë¡œ ì¶”ì²œí•˜ëŠ” ê²ƒì´ `defaultdict`    
* defaultdictëž€ : ì²˜ìŒë¶€í„° ë””í´íŠ¸ ê°’ìœ¼ë¡œ ì„¤ì •í•´  dictë¥¼ ìƒì„±í•œë‹¤.
```python
from collections import defaultdict

class Visits:
    def __init__(self):
        self.data = defaultdict(set)
    
    def add(self, country, city):
        self.data[country].add(city)
```

## Better Way 18. `__missing__`ì„ ì‚¬ìš©í•´ í‚¤ì— ë”°ë¼ ë‹¤ë¥¸ ë””í´íŠ¸ ê°’ì„ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë‘ë¼.
**setdefaultì˜ ë¬¸ì œ**    
```python
pictures = {}
path = 'profile_1234.png'
try:
	handle = pictures.setdefault(path, open(path, 'a+b'))
except OSError:
	print('error')
	raise
else:
	handle.seek(0)
	image_data = handle.read()
```
* ê°’ì´ ìžˆë“  ì—†ë“  opení•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
* setdefault ì¤„ì—ì„œ exceptionì´ ë°œìƒí–ˆì„ ë•Œ ì–´ëŠ ê³³ì—ì„œ ë°œìƒí•œ ê²ƒì¸ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.    

**defaultdictì˜ ë¬¸ì œ**
```python
from collections import defaultdict
def open_picture(profile_path):
	try:
		return open(profile_path, 'a+b')
	except OSError:
		print('error')
		raise

pictures = defaultdict(open_picture)
```
defaultdict íŒŒë¼ë¯¸í„°ë¡œ ì¸ìžê°€ ìžˆëŠ” í•¨ìˆ˜ë¥¼ ë„˜ê¸¸ ìˆ˜ ì—†ì–´ default ê°’ì„ ì •ì˜í•˜ì§€ ëª»í•œë‹¤.    

ì´ëŸ° ë¬¸ì œê°€ ìžˆì„ ë•ŒëŠ” dictíƒ€ìž…ì˜ í•˜ìœ„ í´ëž˜ìŠ¤ë¥¼ ë§Œë“¤ê³  `__missing__` ì´ë¼ëŠ” íŠ¹ë³„ ë©”ì„œë“œë¥¼ êµ¬í˜„í•´ ë¡œì§ì„ ì»¤ìŠ¤í…€í•˜ê²Œ ë§Œë“¤ì–´ë¼.    
`__missing__` : êµ¬í˜„ëœ ê²½ìš°ë§Œ KeyError ì˜ˆì™¸ ë°œìƒì‹œ í˜¸ì¶œ
```python
# ì˜ˆì œ
class Pictures(dict):
	def __missing__(self, key):
		value = open_picture(key)
		self[key] = value
		return value
```

> â“set: ì§‘í•© ìžë£Œí˜• (https://wikidocs.net/1015)    
> íŠ¹ì§•
> 1. ìˆœì„œê°€ ì—†ë‹¤.
> 2. ì¤‘ë³µê°’ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

> â“ try/except/else/finally    
![image](https://user-images.githubusercontent.com/63278762/124152880-dd8c2700-dace-11eb-9e90-1b300396f780.png)
https://gomguard.tistory.com/122

## Better Way 19. í•¨ìˆ˜ê°€ ì—¬ëŸ¬ ê°’ì„ ë°˜í™˜í•˜ëŠ” ê²½ìš° ì ˆëŒ€ë¡œ ë„¤ ê°’ ì´ìƒì„ ì–¸íŒ¨í‚¹í•˜ì§€ ë§ë¼.
í•¨ìˆ˜ ë°˜í™˜ ì‹œí‚¬ ë•Œ ë°˜í™˜ê°’ì´ ë§Žì•„ì§€ë©´ í˜¼ë™ì„ ì£¼ê¸°ë„ ì‰½ê³ , ì‹¤ìˆ˜í•˜ê¸°ë„ ì‰¬ì›Œì§€ê¸° ë•Œë¬¸ì— ë„¤ ê°’ ì´ìƒì„ ì–¸íŒ¨í‚¹í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤.    
ë§Œì•½ 4ê°œ ì´ìƒ ì–¸íŒ¨í‚¹ í•´ì•¼ í•œë‹¤ë©´ `namedtuple`ì„ ì‚¬ìš©í•´ë¼.
#### namedtuple 
ì¸ë±ìŠ¤ë¡œ ê°’ì— ì ‘ê·¼í•˜ëŠ” ê¸°ë³¸ íŠœí”Œê³¼ ë‹¤ë¥´ê²Œ í‚¤ ê°’ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ íŠœí”Œ
```python
from collections import namedtuple

#namedtuple ì˜ˆì‹œ1
Person = collections.namedtuple("Person", 'name age gender')

P1 = Person('Jhon', 28, 'ë‚¨')
P2 = Person(name='Sally', age=28, gender='ì—¬')

for n in [P1, P2]:
    print('%sëŠ”(ì€) %dì„¸ì˜ %sì„± ìž…ë‹ˆë‹¤.' %n)

#ê²°ê³¼
#JhonëŠ”(ì€) 28ì„¸ì˜ ë‚¨ì„± ìž…ë‹ˆë‹¤.
#SallyëŠ”(ì€) 28ì„¸ì˜ ì—¬ì„± ìž…ë‹ˆë‹¤.

print(P1.name, P1.age, P1.gender)
print(P2.name, P2.age, P2.gender)

'''ê²°ê³¼
Jhon 28 ë‚¨
Sally 28 ì—¬
'''
```

> â“ ê²½ëŸ‰í™” í´ëž˜ìŠ¤    
> ë‹¤ë¥¸ ë™ìž‘ì„ í•˜ì§€ ì•Šê³  ë³€ìˆ˜ë§Œ ì„ ì–¸í•œ í´ëž˜ìŠ¤

## Better Way 20. Noneì„ ë°˜í™˜í•˜ê¸°ë³´ë‹¤ëŠ” ì˜ˆì™¸ë¥¼ ë°œìƒì‹œì¼œë¼
```python
def careful_divide(a,b):
	try:
		return a / b
	except ZeroDivisionError:
		return None

x, y = 1, 0
result = careful_divide(x,y) # result = None
if result is None:
	print('error')


x, y = 0, 5
result = carefult_divide(x,y) # result = 0
if not result:
	print('error')
```
Noneê³¼ 0 ë‘˜ë‹¤ falseë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë™ì¼í•œ ê°’ìœ¼ë¡œ ë³´ëŠ” ì¡°ê±´ë¬¸ì´ ë§Œë“¤ì–´ì§ˆ ìˆ˜ë„ ìžˆë‹¤.

* í•´ê²° ë°©ë²• 1 : ë°˜í™˜ ê°’ì„ íŠœí”Œë¡œ ë¶„ë¦¬. ì²«ë²ˆì¨°ëŠ” ì„±ê³µ ì—¬ë¶€, ë‘ë²ˆì¨°ëŠ” ì„±ê³µí–ˆì„ ë–„ ì‹¤ì œ ê²°ê³¼
```python
def careful_divide(a,b):
	try:
		return True, a / b
	except ZeroDivisionError:
		return False, None
```
* í•´ê²° ë°©ë²• 2 : Noneì„ ë°˜í™˜í•˜ì§€ ì•Šê³  Exceptionì´ ë°œìƒí•œ ê²½ìš° ValueError Exceptionì„ ë°œìƒì‹œì¼œ ì²˜ë¦¬
```python
def careful_divide(a,b):
	try:
		return a/ b
	except ZeroDivisionError as e:
		raise ValueError('error')
```
ì´ë•Œ DocStringê³¼ Annotationìœ¼ë¡œ ëª…ì‹œí•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.
```python
def careful_divide(a: float, b: float) -> float:
"""
Raises:
	ValueError: bê°€ 0ì´ì–´ì„œ ë‚˜ëˆ—ì…ˆì„ í•  ìˆ˜ ì—†ì„ë•Œ
"""
    try:
		return a/ b
	except ZeroDivisionError as e:
		raise ValueError('error')
```
## Better Way 21. ë³€ìˆ˜ ì˜ì—­ê³¼ í´ë¡œì €ì˜ ìƒí˜¸ìž‘ìš© ë°©ì‹ì„ ì´í•´í•˜ë¼.
```python
def sort_priority(values, group):
	def helper(x):
		if x in group:
			return (0, x)
		return (1, x)
	values.sort(key=helper) # ì¼ê¸‰ì‹œë¯¼ê°ì²´ì¸ helperê°€ ì¸ìžë¡œ ë“¤ì–´ê°

numbers = [8, 3, 1, 2, 5, 4, 7, 6]
group = [2, 3, 5, 7]
sort_priority(numbers, group)
print(numbers)

>>> 
[2, 3, 5, 7, 1, 4, 6, 8]
```
> â“ ì¼ê¸‰ ì‹œë¯¼ ê°ì²´    
> ì¼ê¸‰ ê°ì²´(ì˜ì–´: first-class object)ëž€ ë‹¤ë¥¸ ê°ì²´ë“¤ì— ì¼ë°˜ì ìœ¼ë¡œ ì ìš© ê°€ëŠ¥í•œ ì—°ì‚°ì„ ëª¨ë‘ ì§€ì›í•˜ëŠ” ê°ì²´ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
> 1. ë³€ìˆ˜ì— í• ë‹¹ ê°€ëŠ¥í•˜ë‹¤
> 2. í•¨ìˆ˜ì˜ ì¸ìžë¡œ ì „ë‹¬ë  ìˆ˜ ìžˆë‹¤.
> 3. ë™ë“±í•¨ì„ íŒë‹¨í•  ìˆ˜ ìžˆë‹¤.
> 4. í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ì´ ë  ìˆ˜ ìžˆë‹¤.    
> * ì°¸ê³ : https://ko.wikipedia.org/wiki/%EC%9D%BC%EA%B8%89_%EA%B0%9D%EC%B2%B4

* í´ë¡œì € í•¨ìˆ˜ : ìžì‹ ì„ ë‘˜ëŸ¬ì‹¼ ìŠ¤ì½”í”„ì˜ ìƒíƒœê°’ì„ ê¸°ì–µí•˜ëŠ” í•¨ìˆ˜
```python
def calc():
    a = 3
    b = 5
    def mul_add(x): # í´ë¡œì € í•¨ìˆ˜
        return a * x + b
    return mul_add  
 
c = calc()
print(c(1), c(2), c(3), c(4), c(5))

>>>
8, 11, 14, 17, 20
```
> #### í´ë¡œì €ì˜ ì¡°ê±´
> 1. í•´ë‹¹ í•¨ìˆ˜ëŠ” ì–´ë–¤ í•¨ìˆ˜ ë‚´ì˜ ì¤‘ì²©ëœ í•¨ìˆ˜ì—¬ì•¼ í•œë‹¤.
> 2. í•´ë‹¹ í•¨ìˆ˜ëŠ” ìžì‹ ì„ ë‘˜ëŸ¬ì‹¼(enclose) í•¨ìˆ˜ ë‚´ì˜ ìƒíƒœê°’ì„ ë°˜ë“œì‹œ ì°¸ì¡°í•´ì•¼ í•œë‹¤.
> 3. í•´ë‹¹ í•¨ìˆ˜ë¥¼ ë‘˜ëŸ¬ì‹¼ í•¨ìˆ˜ëŠ” ì´ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤.
>
> #### í´ë¡œì €ì˜ ìž¥ì 
> 1. ê´€ë¦¬ì™€ ì±…ìž„ì„ ëª…í™•ížˆ í•  ìˆ˜ ìžˆë‹¤.
> 2. ê° ë³€ìˆ˜ê°€ ì„žì—¬ ë¶ˆí•„ìš”í•œ ì¶©ëŒì„ ë°©ì§€í•  ìˆ˜ ìžˆë‹¤.
>
> ì°¸ê³ : https://shoark7.github.io/programming/python/closure-in-python#3

```python
def sort_priority2(numbers, group):
	found = False
	def helper(x):
		if x in group:
			found = True # ì˜ì—­ ì§€ì • ë²„ê·¸ ë°œìƒ
			return (0, x)
		return (1, x)
	numbers.sort(key=helper)

found = sort_priority2(numbers, group)
print('ë°œê²¬:', found)
print(numbers)

>>>
ë°œê²¬: False
[2, 3, 5, 7, 1, 4, 6, 8]
```
helper ì•ˆ foundê°€ ë°”ê¹¥ foundë¥¼ ë°”ë¼ë³´ëŠ”ê²Œ ì•„ë‹Œ helper ì•ˆì— ì§€ì—­ë³€ìˆ˜ë¡œ ì„ ì–¸ì´ ë˜ì—ˆë‹¤. ì´ê±¸ ëª…í™•í•˜ê²Œ ì •í•´ì£¼ë ¤ë©´ nonlocalì„ ì“°ë©´ ëœë‹¤.
```python
def sort_priority2(numbers, group):
	found = False
	def helper(x):
        nonlocal found
		if x in group:            
			found = True # ì˜ì—­ ì§€ì • ë²„ê·¸ ë°œìƒ
			return (0, x)
		return (1, x)
	numbers.sort(key=helper)
```

í•˜ì§€ë§Œ ì €ìžëŠ” ì´ ë°©ë²•ë„ í•¨ìˆ˜ê°€ ê¸¸ì–´ì§€ë©´ ì´í•´í•˜ê¸° íž˜ë“¤ì–´ì§„ë‹¤ëŠ” ì´ìœ ë¡œ ë„ìš°ë¯¸ í•¨ìˆ˜ë¡œ ë¶€ë¥´ë¼ê³  í•œë‹¤.
```python
class Sorter:
	def __init__(self, group):
		self.group = group
		self.found = False

	def __call__(self, x):
		if x in self.group:
			self.found = True
			return (0, x)
		return (1, x)
	numbers.sort(key=helper)

sorter = Sorter(group)
numbers.sort(key=sorter)
assert sorter.found is True
```

> â“`__call__` : í´ëž˜ìŠ¤ì˜ ê°ì²´ë„ í˜¸ì¶œí•  ìˆ˜ ìžˆê²Œ í•˜ëŠ” ë§¤ì§ë©”ì„œë“œ    
> ì°¸ì¡° : https://jinmay.github.io/2019/12/03/python/python-callable/